{% extends 'layouts/base.html' %}
{% load staticfiles %}

{% block title %}
    Home
{% endblock %}


{% block content %}
    <div id="map">
        <div class="mdl-layout mdl-js-layout">
        {% include 'layouts/navbar.html' %}
            <main class="mdl-layout__content">

            </main>
        </div>
    </div>
{% endblock %}


{% block script %}
    <script src="{% static 'js/leaflet_map.js' %}"></script>
    <script>


  var map = L.map('map');

  var higherOpacity = new L.Control.higherOpacity();
  map.addControl(higherOpacity);
  var lowerOpacity = new L.Control.lowerOpacity();
  map.addControl(lowerOpacity);
  var opacitySlider = new L.Control.opacitySlider();
  map.addControl(opacitySlider);

  base = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
      attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
      maxZoom: 18,
      id: 'nirgn975.cigmtjxyw000rc3knz02njkhn',
      accessToken: 'pk.eyJ1IjoibmlyZ245NzUiLCJhIjoiY2lnbXRqeTcxMDAwdmx6a3RueGViemV0eCJ9.3wBhw04dxzXHfd56yUfufQ'
  }).addTo(map);

    layerControl(map, base)

    var layer = L.geoJson();

    $.getJSON("{% url 'data' %}", function (data) {
    	layer.addData(data);
    });

    layer.setOpacity = function(f){
        this.setStyle({'opacity': 0.2 + f  ,  'fillOpacity':f - 0.4})
    }

    map.addLayer(layer);
    opacitySlider.setOpacityLayer(layer)


	map.setView([40.72228267283148, -74.01351928710938], 10);


    </script>
{% endblock %}